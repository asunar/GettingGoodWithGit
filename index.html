some bug fixed
added some lines
